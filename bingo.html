<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Linux Package Manager Hell Bingo</title>
    <script defer data-domain="cooklang.org" src="https://plausible.io/js/script.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu+Mono:wght@400;700&display=swap');

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Ubuntu Mono', 'Courier New', monospace;
            background: linear-gradient(135deg, #282a36 0%, #44475a 50%, #6272a4 100%);
            min-height: 100vh;
            color: #f8f8f2;
            padding: 10px;
            overflow-x: hidden;
        }

        .container {
            background: #282a36;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            position: relative;
            border: 2px solid #50fa7b;
            max-width: 950px;
            margin: 0 auto;
        }

        .terminal-header {
            background: #44475a;
            margin: -15px -15px 10px -15px;
            padding: 8px 15px;
            border-radius: 8px 8px 0 0;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8em;
        }

        .terminal-button {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }

        .close { background: #ff5555; }
        .minimize { background: #ffb86c; }
        .maximize { background: #50fa7b; }

        .terminal-text {
            margin-left: 10px;
            color: #f8f8f2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        h1 {
            text-align: center;
            color: #50fa7b;
            margin: 10px 0;
            font-size: clamp(1.3em, 4vw, 2em);
            text-shadow: 0 0 10px rgba(80, 250, 123, 0.5);
        }

        .subtitle {
            text-align: center;
            color: #ff79c6;
            margin-bottom: 10px;
            font-size: clamp(0.8em, 2.5vw, 1.1em);
            padding: 0 10px;
        }

        .status-bar {
            background: #44475a;
            padding: 8px;
            margin: 8px 0;
            border-radius: 5px;
            font-size: clamp(0.7em, 2vw, 0.9em);
            color: #8be9fd;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .error-message {
            color: #ff5555;
            text-align: center;
            margin-bottom: 10px;
            font-size: clamp(0.7em, 2vw, 0.9em);
            background: rgba(255, 85, 85, 0.1);
            padding: 5px;
            border-radius: 3px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: clamp(3px, 1vw, 6px);
            margin: 15px 0;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .bingo-cell {
            aspect-ratio: 1;
            border: 2px solid #6272a4;
            background: #44475a;
            cursor: pointer;
            padding: clamp(2px, 0.8vw, 8px);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: clamp(0.45em, 1.8vw, 0.72em);
            transition: all 0.2s ease;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
            color: #f8f8f2;
            line-height: 1.1;
            word-break: break-word;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }

        .bingo-cell:active {
            transform: scale(0.95);
            box-shadow: 0 0 15px rgba(80, 250, 123, 0.6);
        }

        .bingo-cell.marked {
            background: linear-gradient(135deg, #ff5555 0%, #ff79c6 100%);
            color: white;
            font-weight: bold;
            animation: glitch 0.5s ease;
            border-color: #ff5555;
        }

        .bingo-cell.marked::after {
            content: "üíÄ";
            position: absolute;
            font-size: clamp(1.5em, 3vw, 2em);
            opacity: 0.3;
            animation: spin 3s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .bingo-cell.free {
            background: linear-gradient(135deg, #bd93f9 0%, #ff79c6 100%);
            color: white;
            font-weight: bold;
            cursor: default;
            border-color: #bd93f9;
            animation: rainbow 3s linear infinite;
        }

        @keyframes rainbow {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(180deg); }
        }

        @keyframes glitch {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(-1px, 1px); }
            40% { transform: translate(-1px, -1px); }
            60% { transform: translate(1px, 1px); }
            80% { transform: translate(1px, -1px); }
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 15px;
        }

        button {
            padding: clamp(10px, 2vw, 12px) clamp(8px, 2vw, 20px);
            background: #50fa7b;
            color: #282a36;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: clamp(0.75em, 2.5vw, 1em);
            transition: all 0.2s ease;
            font-weight: bold;
            font-family: 'Ubuntu Mono', monospace;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            touch-action: manipulation;
            -webkit-appearance: none;
        }

        button:active {
            transform: scale(0.95);
            box-shadow: 0 2px 10px rgba(80, 250, 123, 0.5);
        }

        button.full-width {
            grid-column: 1 / -1;
        }

        .winner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #282a36;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.8);
            z-index: 1000;
            text-align: center;
            width: 90%;
            max-width: 400px;
            border: 3px solid #ff5555;
        }

        .winner h2 {
            color: #ff5555;
            font-size: clamp(1.5em, 5vw, 2.5em);
            margin-bottom: 15px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .winner p {
            font-size: clamp(0.9em, 2.5vw, 1.1em);
            margin: 10px 0;
            color: #f8f8f2;
        }

        .achievement {
            color: #50fa7b;
            font-weight: bold;
            font-size: clamp(0.8em, 2vw, 1em);
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 999;
        }

        .kernel-panic {
            animation: panic 0.1s infinite;
        }

        @keyframes panic {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        .stats {
            text-align: center;
            margin: 10px 0;
            font-size: clamp(0.7em, 2vw, 0.9em);
            color: #8be9fd;
            padding: 0 5px;
            line-height: 1.4;
        }

        /* Tablet and larger phones in landscape */
        @media (min-width: 600px) {
            .container {
                padding: 20px;
            }

            .terminal-header {
                margin: -20px -20px 15px -20px;
                padding: 10px 20px;
            }

            .controls {
                grid-template-columns: repeat(3, 1fr);
            }

            button:last-child {
                grid-column: 2 / 3;
            }

            .bingo-cell {
                font-size: 0.65em;
            }
        }

        /* Large tablets and desktop */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }

            .container {
                padding: 30px;
            }

            .terminal-header {
                margin: -30px -30px 20px -30px;
                padding: 10px 30px;
                font-size: 1em;
            }

            .terminal-button {
                width: 12px;
                height: 12px;
            }

            .controls {
                display: flex;
                justify-content: center;
                gap: 10px;
            }

            button {
                padding: 12px 20px;
                font-size: 14px;
            }

            button.full-width {
                grid-column: auto;
            }

            .bingo-cell {
                padding: 8px;
                font-size: 0.68em;
            }

            .bingo-cell:hover {
                transform: scale(1.05);
                box-shadow: 0 0 20px rgba(80, 250, 123, 0.5);
                background: #50495e;
                border-color: #50fa7b;
            }
        }

        /* Prevent text selection on mobile */
        @media (max-width: 768px) {
            * {
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
        }

        /* iOS specific fixes */
        @supports (-webkit-touch-callout: none) {
            body {
                -webkit-text-size-adjust: 100%;
            }

            button {
                -webkit-appearance: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="terminal-header">
            <span class="terminal-button close"></span>
            <span class="terminal-button minimize"></span>
            <span class="terminal-button maximize"></span>
            <span class="terminal-text">root@localhost:~#</span>
        </div>

        <h1>üî• Package Manager Hell üî•</h1>
        <p class="subtitle">Where sudo doesn't fix everything</p>
        <div class="error-message" id="errorMessage">E: dpkg returned error code (1)</div>

        <div class="status-bar" id="statusBar">
            Reading package lists... Building dependency tree...
        </div>

        <div class="bingo-grid" id="bingoGrid"></div>

        <div class="stats" id="stats">
            Broken: 0 | Conflicts: 0 | Sanity: 100%
        </div>

        <div class="controls">
            <button onclick="resetBoard()">üîÑ Update</button>
            <button onclick="clearBoard()">üßπ Purge</button>
            <button onclick="autoMark()">üé≤ Segfault</button>
            <button onclick="speedrun()">üí£ Force</button>
            <button class="full-width" onclick="kernelPanic()">‚ò†Ô∏è Kernel Panic!</button>
        </div>
    </div>

    <div class="overlay" id="overlay" onclick="hideWinner()"></div>
    <div class="winner" id="winnerModal">
        <h2>‚ö†Ô∏è KERNEL PANIC ‚ö†Ô∏è</h2>
        <p id="winMessage">Segfault (core dumped)</p>
        <p style="font-size: 2em;">üíÄüêßüíÄ</p>
        <p class="achievement" id="achievement">Achievement unlocked!</p>
        <button onclick="hideWinner()">sudo reboot</button>
    </div>

    <script>
        const falsehoods = [
            '"Just apt install it"\n(500 dependencies)',
            'PPAs are safe\nand maintained',
            'Snap/Flatpak/AppImage\nare the same thing',
            '"Works on Ubuntu"\n= works everywhere',
            '/usr/local won\'t\nbreak anything',
            'Package names\nare consistent\n(lib? -dev? -devel?)',
            'Version in repo\nis recent (2010)',
            'sudo makes\neverything work',
            'Dependency hell\nis a myth',
            'Rolling release\n= stable',
            'AUR is perfectly safe\n(makepkg go brrr)',
            'Conflicts resolved\nautomatically',
            'FREE SPACE:\nüî• /dev/null\nas a service üî•',
            'dpkg --force\nwon\'t break system',
            'Mix repos freely\n(what could go wrong?)',
            'Held packages\nare documented',
            '"Unmet dependencies"\nis helpful',
            'Python 2 & 3\ncoexist peacefully',
            'apt vs apt-get\nvs aptitude\n(pick one)',
            'Make install\ntracks files',
            'ldconfig will\nfind it eventually',
            'Orphaned packages\nclean themselves',
            '"Breaks: *"\nin control file',
            'Compile from source\n"it\'s easy"',
            'rm /var/lib/dpkg/lock\nis the solution'
        ];

        const statusMessages = [
            "E: Could not get lock",
            "Unmet dependencies:",
            "dpkg: error processing",
            "Potentially harmful",
            "ldconfig: not a symlink",
            "apt-key deprecated",
            "Repository changed",
            "Processing errors",
            "No space left",
            "Hash Sum mismatch",
            "GPG error"
        ];

        const achievements = [
            "Dependency Hell Survivor",
            "Broke Prod on Friday",
            "Mixed Repos Champion",
            "3AM Kernel Compiler",
            "/usr/local Chaos",
            "PPA Addiction",
            "Orphan Collector",
            "Force Install Master",
            "Python Time Traveler"
        ];

        const winMessages = [
            "Segfault (core dumped)",
            "Kernel NULL pointer",
            "Unable to mount root",
            "Attempted to kill init!",
            "Paging request failed",
            "Out of memory",
            "systemd[1]: Failed"
        ];

        let boardState = new Array(25).fill(false);
        boardState[12] = true;
        let markedCount = 1;
        let touchStartTime = 0;

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function initializeBoard() {
            const grid = document.getElementById('bingoGrid');
            grid.innerHTML = '';

            const shuffled = [...falsehoods];
            const freeIndex = shuffled.indexOf('FREE SPACE:\nüî• /dev/null\nas a service üî•');
            if (freeIndex !== -1) {
                shuffled.splice(freeIndex, 1);
            }
            const randomized = shuffleArray(shuffled);
            randomized.splice(12, 0, 'FREE SPACE:\nüî• /dev/null\nas a service üî•');

            randomized.forEach((text, index) => {
                const cell = document.createElement('div');
                cell.className = 'bingo-cell';
                if (index === 12) {
                    cell.className += ' free marked';
                }
                cell.innerHTML = text.replace(/\n/g, '<br>');

                // Better touch handling
                cell.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    touchStartTime = Date.now();
                    cell.style.transform = 'scale(0.95)';
                });

                cell.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    const touchDuration = Date.now() - touchStartTime;
                    cell.style.transform = '';
                    if (touchDuration < 500) { // Not a long press
                        toggleCell(index);
                    }
                });

                cell.addEventListener('click', (e) => {
                    if (!('ontouchstart' in window)) {
                        toggleCell(index);
                    }
                });

                grid.appendChild(cell);
            });

            updateStats();
            updateStatusBar();
        }

        function toggleCell(index) {
            if (index === 12) return;

            boardState[index] = !boardState[index];
            const cells = document.querySelectorAll('.bingo-cell');
            if (boardState[index]) {
                cells[index].classList.add('marked');
                markedCount++;
                updateStatusBar();

                // Haptic feedback if available
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }

                if (Math.random() > 0.6) {
                    showTerminalMessage();
                }
            } else {
                cells[index].classList.remove('marked');
                markedCount--;
            }

            updateStats();
            checkWinner();
        }

        function updateStatusBar() {
            const messages = [
                `Reading... ${markedCount * 47} broken`,
                `dpkg: ${markedCount * 3} errors`,
                `chaos v${markedCount}.0 installing`,
                `E: ${markedCount} conflicts`,
                `Triggers... ${markedCount * 10}%`
            ];

            document.getElementById('statusBar').textContent =
                messages[Math.floor(Math.random() * messages.length)];
        }

        function showTerminalMessage() {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = statusMessages[Math.floor(Math.random() * statusMessages.length)];
            errorDiv.style.animation = 'glitch 0.5s ease';
            setTimeout(() => {
                errorDiv.style.animation = '';
            }, 500);
        }

        function updateStats() {
            const sanity = Math.max(0, 100 - (markedCount * 4));
            const broken = markedCount * 3;
            const conflicts = Math.floor(markedCount * 1.5);

            document.getElementById('stats').innerHTML =
                `Broken: ${broken} | Conflicts: ${conflicts} | Sanity: ${sanity}%${sanity <= 20 ? '‚ò†Ô∏è' : ''}`;
        }

        function checkWinner() {
            for (let row = 0; row < 5; row++) {
                if (checkLine(row * 5, 1, 5)) {
                    showWinner();
                    return;
                }
            }

            for (let col = 0; col < 5; col++) {
                if (checkLine(col, 5, 5)) {
                    showWinner();
                    return;
                }
            }

            if (checkLine(0, 6, 5) || checkLine(4, 4, 5)) {
                showWinner();
            }
        }

        function checkLine(start, step, count) {
            for (let i = 0; i < count; i++) {
                if (!boardState[start + i * step]) {
                    return false;
                }
            }
            return true;
        }

        function showWinner() {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('winnerModal').style.display = 'block';
            document.getElementById('winMessage').textContent = winMessages[Math.floor(Math.random() * winMessages.length)];
            document.getElementById('achievement').textContent = `Achievement: ${achievements[Math.floor(Math.random() * achievements.length)]}`;

            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200]);
            }
        }

        function hideWinner() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('winnerModal').style.display = 'none';
        }

        function resetBoard() {
            boardState = new Array(25).fill(false);
            boardState[12] = true;
            markedCount = 1;
            initializeBoard();
            document.getElementById('errorMessage').textContent = 'E: dpkg returned error (1)';

            if (navigator.vibrate) {
                navigator.vibrate(30);
            }
        }

        function clearBoard() {
            boardState = new Array(25).fill(false);
            boardState[12] = true;
            markedCount = 1;
            const cells = document.querySelectorAll('.bingo-cell');
            cells.forEach((cell, index) => {
                if (index !== 12) {
                    cell.classList.remove('marked');
                }
            });
            updateStats();
            updateStatusBar();
            document.getElementById('errorMessage').textContent = 'State information... Done';
        }

        function autoMark() {
            const unmarked = [];
            for (let i = 0; i < 25; i++) {
                if (i !== 12 && !boardState[i]) {
                    unmarked.push(i);
                }
            }
            if (unmarked.length > 0) {
                const randomIndex = unmarked[Math.floor(Math.random() * unmarked.length)];
                toggleCell(randomIndex);
            }
        }

        function speedrun() {
            document.getElementById('statusBar').textContent = 'dist-upgrade --force...';
            let count = 0;
            const interval = setInterval(() => {
                autoMark();
                count++;
                if (count >= 5 || markedCount >= 20) {
                    clearInterval(interval);
                    document.getElementById('statusBar').textContent = 'System undefined!';
                }
            }, 300);
        }

        function kernelPanic() {
            document.body.classList.add('kernel-panic');
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100, 50, 100]);
            }
            setTimeout(() => {
                document.body.classList.remove('kernel-panic');
            }, 3000);

            for (let i = 0; i < 8; i++) {
                setTimeout(() => autoMark(), i * 200);
            }
        }

        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Initialize
        initializeBoard();
    </script>

    <footer style="text-align: center; margin-top: 30px; padding: 20px 10px; color: #6272a4; font-size: clamp(0.8em, 2vw, 0.9em);">
        <div style="margin-bottom: 10px; color: #8be9fd;">
            Made with üíö and dependency conflicts
        </div>
        <a href="https://cooklang.org" target="_blank" rel="noopener" style="color: #50fa7b; text-decoration: none; font-weight: bold; transition: all 0.3s ease;">
            üç≥ Check out Cooklang.org
        </a>
        <div style="margin-top: 5px; font-size: 0.9em; opacity: 0.8;">
            The plain text cooking ecosystem
        </div>
    </footer>
</body>
</html>
