<!doctype html><html lang=en-ie dir=ltr class="scroll-smooth bg-gray-50"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Meal Planning as Compilation | Cooklang: recipe markup language</title>
<link rel=icon type=image/png href=/favicon.png><link rel="shortcut icon" type=image/png href=/favicon.png><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/prism.min.5e28d0b350553e3561e5f801556f07d1046d05bbab0b9c05eacc2b4e55ca6a74.css integrity="sha256-XijQs1BVPjVh5fgBVW8H0QRtBburC5wF6swrTlXKanQ=" crossorigin=anonymous><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Lora:ital,wght@0,400;0,500;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><script src=/js/main.9f322db4d8f2e67fb7c90a1215bc4d6cf7b9fc25ef746d30dc317d9fc812c4dc.js integrity="sha256-nzIttNjy5n+3yQoSFbxNbPe5/CXvdG0w3DF9n8gSxNw=" crossorigin=anonymous></script><script src=/js/prism.min.af85882ed81501083e123f60e917984b380bc16ac22a486c579c2ca6e02389f8.js integrity="sha256-r4WILtgVAQg+Ej9g6ReYSzgLwWrCKkhsV5wspuAjifg=" crossorigin=anonymous></script><script src=/js/prism-cooklang.min.02a17849822faf1e497db9a61501860bd531cbe777da855206f6b548896a1066.js integrity="sha256-AqF4SYIvrx5JfbmmFQGGC9Uxy+d32oVSBva1SIlqEGY=" crossorigin=anonymous></script><script defer data-domain=cooklang.org src=https://plausible.io/js/script.outbound-links.tagged-events.js></script><script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body class="min-h-screen bg-gray-50 text-cooklang-gray-800 antialiased flex flex-col overflow-x-hidden"><header class="bg-white border-b border-cooklang-gray-200 sticky top-0 z-50"><div class="container mx-auto px-4"><nav class="flex items-center justify-between py-4"><div class="flex items-center"><a href=/ class="flex items-center space-x-2 hover:opacity-80 transition-opacity"><img alt="Cooklang: recipe markup language" src=/logo.svg class="h-10 w-auto">
<span class="text-2xl font-bold text-cooklang-gray-900">Cooklang</span></a></div><div class="hidden md:flex items-center gap-8"><nav class="flex items-center gap-6"><a href=/ class="text-base font-medium transition-colors duration-150 whitespace-nowrap
text-cooklang-gray-700 hover:text-cooklang-orange">Home
</a><a href=/docs/ class="text-base font-medium transition-colors duration-150 whitespace-nowrap
text-cooklang-gray-700 hover:text-cooklang-orange">Docs
</a><a href=/cli/ class="text-base font-medium transition-colors duration-150 whitespace-nowrap
text-cooklang-gray-700 hover:text-cooklang-orange">CLI
</a><a href=/app/ class="text-base font-medium transition-colors duration-150 whitespace-nowrap
text-cooklang-gray-700 hover:text-cooklang-orange">Mobile App
</a><a href=/blog/ class="text-base font-medium transition-colors duration-150 whitespace-nowrap
text-cooklang-orange">Blog
</a><a href=/about/ class="text-base font-medium transition-colors duration-150 whitespace-nowrap
text-cooklang-gray-700 hover:text-cooklang-orange">About</a></nav><a href=https://www.buymeacoffee.com/dubadub target=_blank rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-gray-900 font-medium text-sm rounded-lg transition-colors duration-150 whitespace-nowrap"><span>☕</span>
<span>Buy me a coffee</span></a></div><button class="md:hidden p-2 hover:bg-gray-100 rounded-md transition-colors" id=mobile-menu-button aria-label="Toggle mobile menu"><svg class="w-6 h-6" fill="none" stroke="currentcolor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg></button></nav></div><div id=mobile-menu class="hidden md:hidden bg-white border-t border-gray-200"><nav class="container mx-auto px-4 py-4 space-y-2"><a href=/ class="block px-4 py-2 text-base font-medium rounded-md transition-colors duration-150
text-cooklang-gray-700 hover:bg-cooklang-gray-100">Home
</a><a href=/docs/ class="block px-4 py-2 text-base font-medium rounded-md transition-colors duration-150
text-cooklang-gray-700 hover:bg-cooklang-gray-100">Docs
</a><a href=/cli/ class="block px-4 py-2 text-base font-medium rounded-md transition-colors duration-150
text-cooklang-gray-700 hover:bg-cooklang-gray-100">CLI
</a><a href=/app/ class="block px-4 py-2 text-base font-medium rounded-md transition-colors duration-150
text-cooklang-gray-700 hover:bg-cooklang-gray-100">Mobile App
</a><a href=/blog/ class="block px-4 py-2 text-base font-medium rounded-md transition-colors duration-150
text-cooklang-gray-700 hover:bg-cooklang-gray-100">Blog
</a><a href=/about/ class="block px-4 py-2 text-base font-medium rounded-md transition-colors duration-150
text-cooklang-gray-700 hover:bg-cooklang-gray-100">About
</a><a href=https://www.buymeacoffee.com/dubadub target=_blank rel="noopener noreferrer" class="block px-4 py-2 bg-yellow-400 text-gray-900 font-medium text-sm rounded-md">☕ Buy me a coffee</a></nav></div></header><main class=flex-1><article class=bg-white><div class="container mx-auto px-4 py-8 max-w-4xl"><header class=mb-8><h1 class="text-4xl font-bold text-cooklang-gray-900 mb-4">Meal Planning as Compilation</h1><div class=text-cooklang-gray-600><time datetime=2025-09-05T00:00:00+00:00>September 5, 2025</time></div></header><div class="prose prose-lg max-w-none text-cooklang-gray-700 overflow-x-auto"><p>I used to think meal planning was for people with too much time. Then I realized I was spending more time not planning meals than it would take to plan them.</p><p>Let me be clear: what I'm about to describe isn't fully built yet. It's how I want meal planning to work, how it should work. Some pieces exist in Cooklang today, others are still being developed. Think of this as a design document for the future of meal planning, not a manual for current software.</p><p>Every evening around 5 PM, the same ritual: stare into the fridge, evaluate ingredients like a puzzle, realize I'm missing something crucial, order takeout. I was treating cooking like an interpreted language - parsing each meal at runtime. What I needed was compilation.</p><h2 id=the-interpreter-problem>The Interpreter Problem</h2><p>Most people cook in interpreted mode. You decide what to eat when you're hungry. You check what you have. You discover you're missing ingredients. You adapt or abandon. This works, technically, the same way you can write production systems in bash scripts. But why would you?</p><p>The cognitive load is enormous. Every meal requires real-time decision making under the worst possible conditions - when you're tired and hungry. It's like debugging code while the server is down. You make bad decisions because you have to make them fast.</p><p>Here's what changed everything: I started treating meal planning like program compilation. Once a week, I write the source code. The compiler (my planning system) turns it into executable instructions. During the week, I just execute.</p><h2 id=the-menu-file>The Menu File</h2><p>A Cooklang menu file is source code for a week of eating. Here's an actual one I use:</p><div class=code-toolbar><pre class=language-cooklang data-language=cooklang><code class=language-cooklang>---
servings: 2
---

==Monday==

Breakfast:
- @oatmeal{2%bowls} with @blueberries{100%g} and @honey
- @coffee{2%cups}

Lunch:
- @./Soups/Minestrone{4%servings} --make double batch

Dinner:
- @./Mains/Sheet-Pan Chicken{2} with @./Sides/Roasted Vegetables{}
- @./Salads/Simple Green{2%servings}

==Tuesday==

Breakfast:
- @yogurt{2%cups} with @granola{100%g} and @banana{2}
- @coffee{2%cups}

Lunch:
- @./Soups/Minestrone{}(leftover from Monday)

Dinner:
- @./Pastas/Aglio e Olio{2} 
- @./Salads/Caesar{2}

-- date night, make something nice

==Wednesday==

Breakfast:
- @scrambled eggs{4} with @toast{4%slices}
- @coffee{2%cups}

Lunch:
- @./Sandwiches/Grilled Cheese{2} with @tomato soup{1%can}

Dinner:
- @./Mains/Thai Green Curry{3} --freeze 1 portion
- @jasmine rice{2%cups}(cooked)

== Snacks ==
- @apples{6}
- @almonds{200%g}
- @hummus{1%container} with @carrots{500%g}
- @greek yogurt{4%cups}
- @dark chocolate{1%bar}</code></pre></div><p>This isn't a wish list. It's a program. Each <code>@</code> reference either pulls in a full recipe or declares a simple ingredient. The system knows that <code>@./Soups/Minestrone{4%servings}</code> means look up that recipe, scale it to 4 servings, add all its ingredients to the shopping list.</p><h2 id=the-compilation-step>The Compilation Step</h2><p>Sunday afternoon, I compile the week. The system reads the menu file and generates:</p><ol><li>A shopping list with exact quantities</li><li>A prep schedule (what needs making when)</li><li>Reminders (defrost chicken Tuesday morning)</li><li>Portion calculations (that double batch of minestrone covers two lunches)</li></ol><p>The magic is that compilation catches errors before they matter. Missing recipe file? Find out Sunday, not Wednesday at 6 PM. Ingredient conflict? (Need all the onions for curry but also for soup?) Resolve it now, when you have options.</p><h2 id=the-snack-buffer-problem>The Snack Buffer Problem</h2><p>Here's what everyone forgets: snacks. You plan three perfect meals, execute flawlessly, then destroy your budget and health with convenience store runs because you didn't plan for reality - humans snack.</p><p>The <code>== Snacks ==</code> section isn't an afterthought. It's a buffer, like allocating extra memory for unexpected operations. Without it, your perfectly planned system fails when real life happens. Kid needs a snack for school. You're hungry at 3 PM. Partner wants something while watching Netflix.</p><p>Planning snacks does three things. First, it makes them visible in your shopping list. Those six apples and container of hummus get purchased with everything else, not grabbed desperately from a gas station at three times the price. Second, it provides known-good options when hunger strikes between meals. The decision is pre-made: apple with almonds, not vending machine cookies. Third, it prevents the cascade failure where unplanned snacking ruins dinner appetite, which shifts the whole schedule.</p><p>The quantities matter. Six apples for two people for three days - that's one per person per day. The 200g of almonds portions out to reasonable daily amounts. The dark chocolate bar isn't denial of pleasure; it's planned pleasure. You're going to eat chocolate anyway. Plan for it or pretend you won't and pay more at checkout.</p><h2 id=the-batch-processing-insight>The Batch Processing Insight</h2><p>The notation <code>--make double batch</code> next to Monday's minestrone isn't a comment - it's an optimization directive. Like loop unrolling in compiler optimization, cooking in batches amortizes fixed costs.</p><p>Chopping onions for one soup takes 5 minutes. Chopping for two takes 6. The oven preheats once whether you're roasting vegetables for two or six. The dishwasher runs regardless. Batch processing in the kitchen follows the same economics as batch processing in computing.</p><p>The <code>--freeze 1 portion</code> notation on Wednesday's curry is forward planning. Future me will thank current me when Thursday is insane and there's curry in the freezer.</p><h2 id=dependencies-and-scheduling>Dependencies and Scheduling</h2><p>Meal planning reveals dependency chains you never noticed. That bread for Wednesday's grilled cheese needs to be fresh. The chicken for Monday needs defrosting Sunday night. The minestrone tastes better on day two, so make it Sunday for Monday.</p><p>This is a directed acyclic graph problem. Each meal has dependencies (ingredients, prep time, equipment). The compiler resolves these into a valid execution order. Sunday: make minestrone, prep vegetables. Monday morning: start slow cooker. Monday evening: just assemble.</p><h2 id=the-constraint-solver>The Constraint Solver</h2><p>Real meal planning works with constraints:</p><ul><li>Budget: $150/week</li><li>Time: 30 minutes on weeknights, 2 hours on Sunday</li><li>Nutrition: protein at each meal, vegetables twice daily</li><li>Variety: no repeating main proteins consecutive days</li><li>Reality: kids won't eat mushrooms, partner hates cilantro</li></ul><p>These aren't preferences; they're system requirements. And here's where Cooklang's report system becomes powerful - it can enforce these constraints programmatically.</p><p>Using templates and the database system, you can validate your menu against reality. The budget constraint becomes a calculation in your template:</p><div class=code-toolbar><pre class=language-jinja2 data-language=jinja2><code class=language-jinja2>{%- set total_cost = namespace(value=0) %}
{%- for ingredient in ingredients %}
{%- set item_cost = db(underscore(ingredient.name) ~ &amp;#34;.cost.per_unit&amp;#34;, 0) * ingredient.quantity %}
{%- set total_cost.value = total_cost.value &#43; item_cost %}
{%- endfor %}

{% if total_cost.value &amp;gt; 150 %}
WARNING: Week exceeds budget at ${{ &amp;#34;%.2f&amp;#34;|format(total_cost.value) }}
{% endif %}</code></pre></div><p>Nutrition constraints check themselves:</p><div class=code-toolbar><pre class=language-jinja2 data-language=jinja2><code class=language-jinja2>{%- for meal in daily_meals %}
{%- set protein = calculate_macros(meal, &amp;#39;protein&amp;#39;) %}
{% if protein &amp;lt; 20 %}
WARNING: {{ meal.name }} lacks adequate protein ({{ protein }}g)
{% endif %}
{%- endfor %}</code></pre></div><p>The variety constraint becomes a simple validation:</p><div class=code-toolbar><pre class=language-jinja2 data-language=jinja2><code class=language-jinja2>{%- set proteins = [] %}
{%- for day in menu %}
{%- set main_protein = extract_protein(day.dinner) %}
{% if main_protein in proteins[-1:] %}
ERROR: Repeating {{ main_protein }} on consecutive days
{% endif %}
{%- set proteins = proteins &#43; [main_protein] %}
{%- endfor %}</code></pre></div><p>The "reality" constraints live in your database as ingredient metadata - mark mushrooms as "kid_friendly: false" and the system can warn when Tuesday's dinner won't work for the whole family.</p><p>This isn't theoretical. The report system with its Jinja2 templates and database integration makes these validations real. Run <code>cook report -t validate-menu.jinja 'weekly.menu' -d ./db</code> and get immediate feedback on whether your plan survives contact with reality.</p><p>The menu file respects constraints or compilation fails. Better to fail at planning time than dinnertime.</p><h2 id=the-leftovers-protocol>The Leftovers Protocol</h2><p>That <code>--leftover from Monday</code> annotation isn't laziness - it's resource management. In programming, we cache expensive computations. In cooking, we cache expensive preparations.</p><p>But leftovers need protocol. Three days for cooked grains. Five for soups and stews. Seven for pickled anything. Beyond that, you're not saving money; you're growing bacteria.</p><p>The menu system tracks this. Tuesday's leftover minestrone is fine. Friday's would be flagged as unsafe. The compiler won't let you food poison yourself.</p><h2 id=error-handling>Error Handling</h2><p>What happens when Tuesday's plan fails? You're exhausted, skip the aglio e olio, order pizza. The system doesn't break. Wednesday's ingredients are still there. Thursday's prep still makes sense.</p><p>This is graceful degradation. One failed execution doesn't crash the whole week. You can resume from any point because each day's plan is independent enough to stand alone but connected enough to share resources.</p><h2 id=the-psychological-compiler>The Psychological Compiler</h2><p>The deepest benefit isn't efficiency - it's removing decision fatigue. Steve Jobs wore the same outfit to save cognitive resources for important decisions. Meal planning is the same principle applied to food.</p><p>When you know Tuesday is aglio e olio, that's not a constraint - it's freedom. Freedom from standing in front of the fridge at 6:30 PM trying to be creative. Freedom from the guilt of another takeout order. Freedom from the stress of improvisation.</p><h2 id=implementation>Implementation</h2><p>Start with three days, not seven. A long compilation unit is harder to debug. Get three days working, then expand. Use real recipes you actually cook, not aspirational ones. The fanciest meal plan you don't execute is worth less than the simple one you do.</p><p>Write it down. The format matters less than the practice. Cooklang menu files, spreadsheets, paper - pick one and commit. The act of planning is more important than the tool.</p><p>Review and refactor weekly. What worked? What didn't? That Thai curry you planned for 30 minutes took an hour - update the time estimate. The kids loved the sheet pan chicken - add it to regular rotation.</p><h2 id=the-payoff>The Payoff</h2><p>Six months into this system, I spend 30 minutes planning and save 5 hours of deciding. Groceries cost 30% less because I buy what I need, not what I might need. Food waste approaches zero because everything has a purpose.</p><p>But the real payoff is peace. At 5 PM on Thursday, I'm not solving problems. I'm executing a plan. The cognitive load of "what's for dinner?" has been paid once, on Sunday, not seven times at the worst possible moment.</p><p>Your meals are going to happen regardless. You can compile them once or interpret them repeatedly. The computer science is clear on which is more efficient.</p><p>Plan your meals. Not because you're organized. Because you're lazy in the good way - the way that makes you optimize repetitive tasks so you can focus on what matters.</p><p>That's not meal prep. That's engineering.</p></div></div></article></main><footer class="bg-cooklang-gray-900 text-white mt-auto"><div class="container mx-auto px-4 py-8"><div class="grid grid-cols-1 md:grid-cols-4 gap-8"><div><h4 class="font-semibold mb-4">Mobile Apps</h4><div class=space-y-2><a href="https://play.google.com/store/apps/details?id=md.cook.android" class=block><img src=/google-play-badge.png alt="Download on Google Play" class=h-10>
</a><a href="https://apps.apple.com/us/app/cooklangapp/id1598799259#?platform=iphone" class=block><img src=/app-store-badge.png alt="Download on App Store" class=h-10></a></div></div><div><h4 class="font-semibold mb-4">Resources</h4><ul class=space-y-2><li><a href=/docs/ class="text-cooklang-gray-300 hover:text-white transition-colors">Documentation</a></li><li><a href=/cli/ class="text-cooklang-gray-300 hover:text-white transition-colors">CLI Tool</a></li><li><a href=/app/ class="text-cooklang-gray-300 hover:text-white transition-colors">Mobile App</a></li><li><a href=https://cooklang.github.io/cooklang-rs/ class="text-cooklang-gray-300 hover:text-white transition-colors">Playground</a></li><li><a href=https://github.com/cooklang/spec/discussions class="text-cooklang-gray-300 hover:text-white transition-colors">Spec Discussions</a></li><li><a href=https://github.com/cooklang class="text-cooklang-gray-300 hover:text-white transition-colors">GitHub</a></li></ul></div><div><h4 class="font-semibold mb-4">Community</h4><ul class=space-y-2><li><a href=https://reddit.com/r/cooklang class="text-cooklang-gray-300 hover:text-white transition-colors">Reddit</a></li><li><a href=https://discord.gg/v7RWBXJ5 class="text-cooklang-gray-300 hover:text-white transition-colors">Discord</a></li><li><a href=https://x.com/cooklangorg class="text-cooklang-gray-300 hover:text-white transition-colors">X (Twitter)</a></li><li><a href=https://bsky.app/profile/cooklang.bsky.social class="text-cooklang-gray-300 hover:text-white transition-colors">Bluesky</a></li><li><a href=https://mas.to/@cooklang class="text-cooklang-gray-300 hover:text-white transition-colors">Mastodon</a></li><li><a href=https://www.youtube.com/channel/UCOZg3EJ1QsE_DqO-ZcMWblw class="text-cooklang-gray-300 hover:text-white transition-colors">YouTube</a></li><li><a href=/blog/index.xml class="text-cooklang-gray-300 hover:text-white transition-colors">RSS Feed</a></li></ul></div><div><h4 class="font-semibold mb-4">About</h4><p class="text-cooklang-gray-300 text-sm">Cooklang is a markup language for recipes that makes it easy to manage your personal recipe collection.</p></div></div><div class="mt-8 pt-8 border-t border-cooklang-gray-700 text-center text-cooklang-gray-400"><p>Copyright © 2021-2025 Cooklang. All rights reserved.</p></div></div></footer><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("pre code, code").forEach(function(e){var t=e.textContent||e.innerText||"",t=t.replace(/&#34;/g,'"').replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");e.textContent=t}),typeof Prism!="undefined"&&Prism.highlightAll()})</script></body></html>